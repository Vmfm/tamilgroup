<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Group Chat - Guest Login</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f5f5f5; text-align:center; }
    #chatBox { width:90%; max-width:600px; height:400px; overflow-y:scroll; border:1px solid #ccc; background:#fff; margin:20px auto; padding:10px; }
    #msg { width:70%; padding:10px; }
    button { padding:10px; }
    .msg { text-align:left; margin:5px; }
    .me { font-weight:bold; color:blue; }
  </style>
</head>
<body>
  <h2>üî• Tamil VM Group Chat (Guest)</h2>
  <div id="chatBox"></div>
  <input type="text" id="msg" placeholder="Type message...">
  <button onclick="send()">Send</button>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>

  <script>
    // üîë Correct Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyB1VbLbqBxCiG_bfGoQgQyapXwHUQ-Q7BU",
      authDomain: "tamil-chat-2d54e.firebaseapp.com",
      databaseURL: "https://tamil-chat-2d54e-default-rtdb.firebaseio.com",
      projectId: "tamil-chat-2d54e",
      storageBucket: "tamil-chat-2d54e.appspot.com",  // ‚úÖ fixed
      messagingSenderId: "804705969240",
      appId: "1:804705969240:web:658df281dd8360843c162d"
    };

    // ‚úÖ Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let name = "Guest-" + Math.floor(Math.random() * 1000);
    let chatBox = document.getElementById("chatBox");

    // üì° Listen for new messages
    db.ref("messages").on("child_added", snapshot => {
      let data = snapshot.val();
      let div = document.createElement("div");
      div.classList.add("msg");
      if (data.user === name) div.classList.add("me");
      div.textContent = `[${data.time}] ${data.user}: ${data.text}`;
      chatBox.appendChild(div);
      chatBox.scrollTop = chatBox.scrollHeight;
    });

    // ‚úçÔ∏è Send message
    function send() {
      let msg = document.getElementById("msg").value;
      if (!msg) return;
      let entry = {
        user: name,
        text: msg,
        time: new Date().toLocaleTimeString()
      };
      db.ref("messages").push(entry);
      document.getElementById("msg").value = "";
    }
  </script>
</body>
</html>
